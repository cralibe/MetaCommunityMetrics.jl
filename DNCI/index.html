<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Dispersal-Niche Continuum Index (DNCI) Functions · MetaCommunityMetrics Documentation</title><meta name="title" content="Dispersal-Niche Continuum Index (DNCI) Functions · MetaCommunityMetrics Documentation"/><meta property="og:title" content="Dispersal-Niche Continuum Index (DNCI) Functions · MetaCommunityMetrics Documentation"/><meta property="twitter:title" content="Dispersal-Niche Continuum Index (DNCI) Functions · MetaCommunityMetrics Documentation"/><meta name="description" content="Documentation for MetaCommunityMetrics Documentation."/><meta property="og:description" content="Documentation for MetaCommunityMetrics Documentation."/><meta property="twitter:description" content="Documentation for MetaCommunityMetrics Documentation."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.png" alt="MetaCommunityMetrics Documentation logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">MetaCommunityMetrics Documentation</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../BetaDiversity/">Beta Diverisity Functions</a></li><li class="is-active"><a class="tocitem" href>Dispersal-Niche Continuum Index (DNCI) Functions</a><ul class="internal"><li><a class="tocitem" href="#Background"><span>Background</span></a></li><li><a class="tocitem" href="#Functionality-Overview"><span>Functionality Overview</span></a></li><li><a class="tocitem" href="#The-Functions"><span>The Functions</span></a></li><li><a class="tocitem" href="#References"><span>References</span></a></li></ul></li><li><a class="tocitem" href="../NicheOverlapIndex/">Niche Overlap Index Function</a></li><li><a class="tocitem" href="../OccupiedPatchesProportion/">Occupied Patches Proportion Function</a></li><li><a class="tocitem" href="../VariabilityMetrics/">Variability Metrics Functions</a></li><li><a class="tocitem" href="../Hypervolume/">Hypervolume Functions</a></li><li><a class="tocitem" href="../Benchmarking/">Benchmarking Julia vs R</a></li><li><a class="tocitem" href="../Acknowledgment/">Acknowledgment</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Dispersal-Niche Continuum Index (DNCI) Functions</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Dispersal-Niche Continuum Index (DNCI) Functions</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/cralibe/MetaCommunityMetrics.jl" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Dispersal-Niche-Continuum-Index-(DNCI)-Functions"><a class="docs-heading-anchor" href="#Dispersal-Niche-Continuum-Index-(DNCI)-Functions">Dispersal-Niche Continuum Index (DNCI) Functions</a><a id="Dispersal-Niche-Continuum-Index-(DNCI)-Functions-1"></a><a class="docs-heading-anchor-permalink" href="#Dispersal-Niche-Continuum-Index-(DNCI)-Functions" title="Permalink"></a></h1><p>The Dispersal-Niche Continuum Index (DNCI) functions in <code>MetaCommunityMetrics</code> quantifies the balance between dispersal and niche processes within a metacommunity, providing insight into community structure and the relative influence of these two key ecological drivers. The function <code>DNCI_multigroup</code>  in this package is adapted from the R package <code>DNCImper</code>: Assembly process identification based on SIMPER analysis. These methods, originally developed by Clarke(1993) and later refined by Gibert &amp; Escarguel(2019) and Vilmi et al.(2021), offer powerful tools for identifying the processes underlying species assembly in metacommunities. </p><h2 id="Background"><a class="docs-heading-anchor" href="#Background">Background</a><a id="Background-1"></a><a class="docs-heading-anchor-permalink" href="#Background" title="Permalink"></a></h2><p>The DNCI functions is built around the Per-SIMPER and DNCI analyses. PerSIMPER, based on the Similarity Percentage (SIMPER) analysis developed by Clarke (1993), assesses the contribution of individual taxa to overall dissimilarity (OAD) between groups of assemblages. PerSIMPER enhances this by comparing empirical SIMPER plots with randomized plots generated through matrix permutation, which helps identify whether niche, dispersal, or both processes are driving community assembly.</p><p>The DNCI (Dispersal-Niche Continuum Index) further extends this approach by transforming the qualitative results of PerSIMPER into a quantitative index, providing a straightforward measure of the influence of niche and dispersal processes on community structure.</p><h2 id="Functionality-Overview"><a class="docs-heading-anchor" href="#Functionality-Overview">Functionality Overview</a><a id="Functionality-Overview-1"></a><a class="docs-heading-anchor-permalink" href="#Functionality-Overview" title="Permalink"></a></h2><p>The DNCI functions in <code>MetaCommunityMetrics</code> allow you to analyze the processes driving species assembly within your dataset. By comparing empirical data with randomized permutations, one can determine the extent to which niche and dispersal processes influence the structure of metacommunities. Before calculating the DNCI, groupings of sites (clusters) are required, as the DNCI relies on analyzing community composition across spatial groups. This package provides a function to perform the necessary clustering, which is not available in the equivalent R package. When the DNCI value is significantly below zero, dispersal processes are likely the dominant drivers of community composition. In contrast, a DNCI value significantly above zero suggests that niche processes play a primary role in shaping community composition. If the DNCI value is not significantly different from zero, it indicates that dispersal and niche processes contribute equally to variations in community composition.</p><h2 id="The-Functions"><a class="docs-heading-anchor" href="#The-Functions">The Functions</a><a id="The-Functions-1"></a><a class="docs-heading-anchor-permalink" href="#The-Functions" title="Permalink"></a></h2><ul><li>create_clusters: Groups sampling locations based on their spatial attributes and species richness, which can then be used to assess DNCI.</li><li>plot_clusters: Visualizes the clusters created, allowing for an intuitive understanding of spatial groupings.</li><li>DNCI_multigroup: Computes the Dispersal-Niche Continuum Index (DNCI) across multiple groups, helping to quantify the relative influence of niche versus dispersal processes.</li></ul><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MetaCommunityMetrics.create_clusters" href="#MetaCommunityMetrics.create_clusters"><code>MetaCommunityMetrics.create_clusters</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">create_clusters(time::Vector{Int}, latitude::Vector{Float64}, longitude::Vector{Float64}, patch::Vector{Int}, total_richness::Vector{Int}) -&gt; Dict{Int, DataFrame}</code></pre><p>This function creates clusters (groupings of patches/sites) for each unique time step in a dataset which can then used for calculating DNCI. Only presnece-absence data can be used. Please remove singletons (taxa/species that occuring at one patch/site within a time step) before using this function.</p><p>Arguments</p><ul><li><code>time::Vector</code>: A vector indicating the time each sample was taken.</li><li><code>latitude::Vector</code>: A vector indicating the latitude of each sample.</li><li><code>longitude::Vector</code>: A vector indicating the longitude of each sample.</li><li><code>patch::Vector</code>: A vector indicating the spatial location (patch) of each sample. At least 10 patches are required for clustering.</li><li><code>total_richness::Vector</code>: A vector indicating the total species richness at each plot at each time step.</li></ul><p>Returns</p><ul><li><code>Dict{Int, DataFrame}</code>: A dictionary where each key represents a unique time point from the input data, with the corresponding value being a <code>DataFrame</code> for that time step. Each <code>DataFrame</code> contains the following columns: <code>Time</code>, <code>Latitude</code>, <code>Longitude</code>, <code>Patch</code>, <code>Total_Richness</code>, and <code>Group</code> (indicating the assigned cluster).</li></ul><p>Details This function performs hierarchical clustering on the geographical coordinates of sampling patches/sites at each unique time step, assuming that organism dispersal occurs within the study region. It incorporates checks and adjustments to ensure the following conditions are met: at least 2 clusters, a minimum of 5 patches/sites per cluster, and that the variation in the number of taxa/species and patches/sites per group does not exceed 40% and 30%, respectively. These conditions are critical for calculating an unbiased DNCI value, and the function will issue warnings if any are not fulfilled.</p><p>Example</p><pre><code class="language-jildoctest hljs">julia&gt; using MetaCommunityMetrics, Pipe, DataFrames

julia&gt; df = load_sample_data()
48735×10 DataFrame
   Row │ Year   Month  Day    Sampling_date_order  plot   Species  Abundance  Presence  Latitude  Longitude 
       │ Int64  Int64  Int64  Int64                Int64  String3  Int64      Int64     Float64   Float64   
───────┼────────────────────────────────────────────────────────────────────────────────────────────────────
     1 │  2010      1     16                    1      1  BA               0         0      35.0     -110.0
     2 │  2010      1     16                    1      2  BA               0         0      35.0     -109.5
     3 │  2010      1     16                    1      8  BA               0         0      35.5     -109.5
     4 │  2010      1     16                    1      9  BA               0         0      35.5     -109.0
     5 │  2010      1     16                    1     11  BA               0         0      35.5     -108.0
   ⋮   │   ⋮      ⋮      ⋮             ⋮             ⋮       ⋮         ⋮         ⋮         ⋮          ⋮
 48731 │  2023      3     21                  117      9  SH               0         0      35.5     -109.0
 48732 │  2023      3     21                  117     10  SH               0         0      35.5     -108.5
 48733 │  2023      3     21                  117     12  SH               1         1      35.5     -107.5
 48734 │  2023      3     21                  117     16  SH               0         0      36.0     -108.5
 48735 │  2023      3     21                  117     23  SH               0         0      36.5     -108.0
                                                                                          48725 rows omitted
                                                                                          
julia&gt; total_presence_df=@pipe df|&gt;
                        groupby(_,[:Species,:Sampling_date_order])|&gt;
                        combine(_,:Presence=&gt;sum=&gt;:Total_Presence) |&gt;
                        filter(row -&gt; row[:Total_Presence] &gt; 1, _)
791×3 DataFrame
 Row │ Species  Sampling_date_order  Total_Presence 
     │ String3  Int64                Int64          
─────┼──────────────────────────────────────────────
   1 │ BA                        41               2
   2 │ BA                        50               2
   3 │ BA                        51               8
   4 │ BA                        52              19
   5 │ BA                        53              18
  ⋮  │    ⋮              ⋮                 ⋮
 787 │ SH                        56               3
 788 │ SH                        60               4
 789 │ SH                        70               3
 790 │ SH                        73               5
 791 │ SH                       117               4
                                    781 rows omitted

julia&gt; total_richness_df= @pipe df|&gt;
                  innerjoin(_,  total_presence_df, on = [:Species, :Sampling_date_order], makeunique = true) |&gt;
                  groupby(_,[:plot,:Sampling_date_order,:Longitude, :Latitude])|&gt;
                  combine(_,:Presence=&gt;sum=&gt;:Total_Richness)|&gt;
                  filter(row -&gt; row[:Total_Richness] &gt; 0, _) 

2565×5 DataFrame
  Row │ plot   Sampling_date_order  Longitude  Latitude  Total_Richness 
      │ Int64  Int64                Float64    Float64   Int64          
──────┼─────────────────────────────────────────────────────────────────
    1 │     1                   41     -110.0      35.0               5
    2 │     2                   41     -109.5      35.0               4
    3 │     4                   41     -108.5      35.0               2
    4 │     8                   41     -109.5      35.5               2
    5 │     9                   41     -109.0      35.5               3
  ⋮   │   ⋮             ⋮               ⋮         ⋮            ⋮
 2561 │     9                  117     -109.0      35.5               5
 2562 │    10                  117     -108.5      35.5               3
 2563 │    12                  117     -107.5      35.5               6
 2564 │    16                  117     -108.5      36.0               4
 2565 │    23                  117     -108.0      36.5               5
                                                       2555 rows omitted

julia&gt; result = create_clusters(total_richness_df.Sampling_date_order, total_richness_df.Latitude, total_richness_df.Longitude, total_richness_df.plot, total_richness_df.Total_Richness)
Dict{Int64, DataFrame} with 117 entries:
  5   =&gt; 17×6 DataFrame…
  56  =&gt; 23×6 DataFrame…
  55  =&gt; 24×6 DataFrame…
  35  =&gt; 23×6 DataFrame…
  110 =&gt; 24×6 DataFrame…
  114 =&gt; 22×6 DataFrame…
  60  =&gt; 24×6 DataFrame…
  30  =&gt; 20×6 DataFrame…
  32  =&gt; 22×6 DataFrame…
  6   =&gt; 19×6 DataFrame…
  67  =&gt; 23×6 DataFrame…
  45  =&gt; 23×6 DataFrame…
  117 =&gt; 24×6 DataFrame…
  73  =&gt; 23×6 DataFrame…
  ⋮   =&gt; ⋮

julia&gt; println(result[1])
14×6 DataFrame
 Row │ Time   Latitude  Longitude  Patch  Total_Richness  Group 
     │ Int64  Float64   Float64    Int64  Int64           Int64 
─────┼──────────────────────────────────────────────────────────
   1 │     1      35.0     -110.0      1               1      1
   2 │     1      35.0     -109.5      2               1      1
   3 │     1      35.5     -109.5      8               1      1
   4 │     1      35.5     -109.0      9               1      1
   5 │     1      35.5     -108.0     11               2      2
   6 │     1      36.0     -109.5     14               2      1
   7 │     1      36.0     -108.0     17               1      2
   8 │     1      36.5     -108.5     22               1      2
   9 │     1      35.0     -107.5      6               1      2
  10 │     1      36.0     -110.0     13               1      1
  11 │     1      36.0     -109.0     15               1      1
  12 │     1      36.5     -109.5     20               1      1
  13 │     1      36.5     -109.0     21               1      2
  14 │     1      36.5     -108.0     23               1      2
</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cralibe/MetaCommunityMetrics.jl">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MetaCommunityMetrics.plot_clusters" href="#MetaCommunityMetrics.plot_clusters"><code>MetaCommunityMetrics.plot_clusters</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">plot_clusters(latitude::Vector{Float64}, longitude::Vector{Float64}, group::Union{AbstractVector, String})</code></pre><p>Plots the clustering result at one time step of the <code>create_cluster</code> function using the geographic coordinates and cluster assignments of patches/sites.</p><p>Arguments</p><ul><li><code>latitude::Vector{Float64}</code>: A vector of latitude coordinates of the patches/sites.</li><li><code>longitude::Vector{Float64}</code>: A vector of longitude coordinates of the patches/sites.</li><li><code>group::Union{AbstractVector, String}</code>: A vector or string indicating the cluster assignments for each data point.</li></ul><p>Returns</p><ul><li>A plot showing the patches/sites colored by the cluster assignment from the <code>create_clusters</code> function.</li></ul><p>Details</p><ul><li>The function assigns a unique color to each cluster and plots the patches/sites based on their geographic coordinates.</li><li>The patches/sites are colored according to the cluster assignment.</li><li>The plot includes black borders around the markers for better visibility.</li></ul><p>Example</p><pre><code class="language-jildoctest hljs">julia&gt; using MetaCommunityMetrics, Pipe, DataFrames

julia&gt; df = load_sample_data()
48735×10 DataFrame
   Row │ Year   Month  Day    Sampling_date_order  plot   Species  Abundance  Presence  Latitude  Longitude 
       │ Int64  Int64  Int64  Int64                Int64  String3  Int64      Int64     Float64   Float64   
───────┼────────────────────────────────────────────────────────────────────────────────────────────────────
     1 │  2010      1     16                    1      1  BA               0         0      35.0     -110.0
     2 │  2010      1     16                    1      2  BA               0         0      35.0     -109.5
     3 │  2010      1     16                    1      8  BA               0         0      35.5     -109.5
     4 │  2010      1     16                    1      9  BA               0         0      35.5     -109.0
     5 │  2010      1     16                    1     11  BA               0         0      35.5     -108.0
   ⋮   │   ⋮      ⋮      ⋮             ⋮             ⋮       ⋮         ⋮         ⋮         ⋮          ⋮
 48731 │  2023      3     21                  117      9  SH               0         0      35.5     -109.0
 48732 │  2023      3     21                  117     10  SH               0         0      35.5     -108.5
 48733 │  2023      3     21                  117     12  SH               1         1      35.5     -107.5
 48734 │  2023      3     21                  117     16  SH               0         0      36.0     -108.5
 48735 │  2023      3     21                  117     23  SH               0         0      36.5     -108.0
                                                                                          48725 rows omitted
                                                                                          
julia&gt; total_presence_df=@pipe df|&gt;
                        groupby(_,[:Species,:Sampling_date_order])|&gt;
                        combine(_,:Presence=&gt;sum=&gt;:Total_Presence) |&gt;
                        filter(row -&gt; row[:Total_Presence] &gt; 1, _)
791×3 DataFrame
 Row │ Species  Sampling_date_order  Total_Presence 
     │ String3  Int64                Int64          
─────┼──────────────────────────────────────────────
   1 │ BA                        41               2
   2 │ BA                        50               2
   3 │ BA                        51               8
   4 │ BA                        52              19
   5 │ BA                        53              18
  ⋮  │    ⋮              ⋮                 ⋮
 787 │ SH                        56               3
 788 │ SH                        60               4
 789 │ SH                        70               3
 790 │ SH                        73               5
 791 │ SH                       117               4
                                    781 rows omitted

julia&gt; total_richness_df= @pipe df|&gt;
                  innerjoin(_,  total_presence_df, on = [:Species, :Sampling_date_order], makeunique = true) |&gt;
                  groupby(_,[:plot,:Sampling_date_order,:Longitude, :Latitude])|&gt;
                  combine(_,:Presence=&gt;sum=&gt;:Total_Richness)|&gt;
                  filter(row -&gt; row[:Total_Richness] &gt; 0, _) 

2565×5 DataFrame
  Row │ plot   Sampling_date_order  Longitude  Latitude  Total_Richness 
      │ Int64  Int64                Float64    Float64   Int64          
──────┼─────────────────────────────────────────────────────────────────
    1 │     1                   41     -110.0      35.0               5
    2 │     2                   41     -109.5      35.0               4
    3 │     4                   41     -108.5      35.0               2
    4 │     8                   41     -109.5      35.5               2
    5 │     9                   41     -109.0      35.5               3
  ⋮   │   ⋮             ⋮               ⋮         ⋮            ⋮
 2561 │     9                  117     -109.0      35.5               5
 2562 │    10                  117     -108.5      35.5               3
 2563 │    12                  117     -107.5      35.5               6
 2564 │    16                  117     -108.5      36.0               4
 2565 │    23                  117     -108.0      36.5               5
                                                       2555 rows omitted

julia&gt; clustering_result = create_clusters(total_richness_df.Sampling_date_order, total_richness_df.Latitude, total_richness_df.Longitude, total_richness_df.plot, total_richness_df.Total_Richness)
Dict{Int64, DataFrame} with 117 entries:
  5   =&gt; 17×6 DataFrame…
  56  =&gt; 23×6 DataFrame…
  55  =&gt; 24×6 DataFrame…
  35  =&gt; 23×6 DataFrame…
  110 =&gt; 24×6 DataFrame…
  114 =&gt; 22×6 DataFrame…
  60  =&gt; 24×6 DataFrame…
  30  =&gt; 20×6 DataFrame…
  32  =&gt; 22×6 DataFrame…
  6   =&gt; 19×6 DataFrame…
  67  =&gt; 23×6 DataFrame…
  45  =&gt; 23×6 DataFrame…
  117 =&gt; 24×6 DataFrame…
  73  =&gt; 23×6 DataFrame…
  ⋮   =&gt; ⋮

julia&gt; println(clustering_result[1])
14×6 DataFrame
 Row │ Time   Latitude  Longitude  Patch  Total_Richness  Group 
     │ Int64  Float64   Float64    Int64  Int64           Int64 
─────┼──────────────────────────────────────────────────────────
   1 │     1      35.0     -110.0      1               1      1
   2 │     1      35.0     -109.5      2               1      1
   3 │     1      35.5     -109.5      8               1      1
   4 │     1      35.5     -109.0      9               1      1
   5 │     1      35.5     -108.0     11               2      2
   6 │     1      36.0     -109.5     14               2      1
   7 │     1      36.0     -108.0     17               1      2
   8 │     1      36.5     -108.5     22               1      2
   9 │     1      35.0     -107.5      6               1      2
  10 │     1      36.0     -110.0     13               1      1
  11 │     1      36.0     -109.0     15               1      1
  12 │     1      36.5     -109.5     20               1      1
  13 │     1      36.5     -109.0     21               1      2
  14 │     1      36.5     -108.0     23               1      2

julia&gt; plot_clusters(result[1].Latitude, result[1].Longitude, result[1].Group)
</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cralibe/MetaCommunityMetrics.jl">source</a></section></article><p>This plot shows the clustering result for time step 1 based on geographic coordinates: <img src="../assets/clustering_result.svg" alt="Cluster Plot"/></p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MetaCommunityMetrics.DNCI_multigroup" href="#MetaCommunityMetrics.DNCI_multigroup"><code>MetaCommunityMetrics.DNCI_multigroup</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">DNCI_multigroup(comm::Matrix, groups::Vector, Nperm::Int=1000; count::Bool=true) -&gt; DataFrame</code></pre><p>Calculates the dispersal-niche continuum index (DNCI) for multiple groups, a metric proposed by Vilmi(2021). The DNCI quantifies the balance between dispersal and niche processes within a metacommunity, providing insight into community structure and the relative influence of these two key ecological drivers. Please remove singletons (taxa/species that occuring at one patch/site within a time step) before using this function.</p><p>Arguments</p><ul><li><code>comm::Matrix</code>: A presence-absence data matrix where rows represent observations (e.g., sites or samples) and columns represent species.</li><li><code>groups::Vector</code>: A vector indicating the group membership for each row in the <code>comm</code> matrix. You can use the <code>create_clusters</code> function to generate the group membership.</li><li><code>Nperm::Int=1000</code>: The number of permutations for significance testing. Default is 1000.</li><li><code>count::Bool=true</code>: A flag indicating whether the numeber of permutations is printed. Default is <code>false</code>.</li></ul><p>Returns</p><ul><li><code>DataFrame</code>: A DataFrame containing the DNCI value, the associate confiden interval (<code>CI_DNCI</code>) and variance (<code>S_DNCI</code>) for each pair of groups.</li></ul><p>Details</p><ul><li>The function calculates the DNCI for each pair of groups in the input data.</li><li>When the DNCI value is significantly below zero, dispersal processes are likely the dominant drivers of community composition. </li><li>In contrast, a DNCI value significantly above zero suggests that niche processes play a primary role in shaping community composition. </li><li>If the DNCI value is not significantly different from zero, it indicates that dispersal and niche processes contribute equally to variations in community composition.</li><li>Please remove singletons (taxa/species that occuring at one patch/site within a time step) before using this function.</li><li>This function is a translation/adaptation of a function from the R package <code>DNCImper</code>, licensed under GPL-3.</li><li>Original package and documentation available at: https://github.com/Corentin-Gibert-Paleontology/DNCImper</li></ul><p>Example</p><pre><code class="language-jildoctest hljs">julia&gt; using MetaCommunityMetrics, Pipe, DataFrames

julia&gt; df = load_sample_data()
48735×10 DataFrame
   Row │ Year   Month  Day    Sampling_date_order  plot   Species  Abundance  Presence  Latitude  Longitude 
       │ Int64  Int64  Int64  Int64                Int64  String3  Int64      Int64     Float64   Float64   
───────┼────────────────────────────────────────────────────────────────────────────────────────────────────
     1 │  2010      1     16                    1      1  BA               0         0      35.0     -110.0
     2 │  2010      1     16                    1      2  BA               0         0      35.0     -109.5
     3 │  2010      1     16                    1      8  BA               0         0      35.5     -109.5
     4 │  2010      1     16                    1      9  BA               0         0      35.5     -109.0
     5 │  2010      1     16                    1     11  BA               0         0      35.5     -108.0
   ⋮   │   ⋮      ⋮      ⋮             ⋮             ⋮       ⋮         ⋮         ⋮         ⋮          ⋮
 48731 │  2023      3     21                  117      9  SH               0         0      35.5     -109.0
 48732 │  2023      3     21                  117     10  SH               0         0      35.5     -108.5
 48733 │  2023      3     21                  117     12  SH               1         1      35.5     -107.5
 48734 │  2023      3     21                  117     16  SH               0         0      36.0     -108.5
 48735 │  2023      3     21                  117     23  SH               0         0      36.5     -108.0
                                                                                          48725 rows omitted
                                                                                          
julia&gt; total_presence_df=@pipe df|&gt;
                        groupby(_,[:Species,:Sampling_date_order])|&gt;
                        combine(_,:Presence=&gt;sum=&gt;:Total_Presence) |&gt;
                        filter(row -&gt; row[:Total_Presence] &gt; 1, _)
791×3 DataFrame
 Row │ Species  Sampling_date_order  Total_Presence 
     │ String3  Int64                Int64          
─────┼──────────────────────────────────────────────
   1 │ BA                        41               2
   2 │ BA                        50               2
   3 │ BA                        51               8
   4 │ BA                        52              19
   5 │ BA                        53              18
  ⋮  │    ⋮              ⋮                 ⋮
 787 │ SH                        56               3
 788 │ SH                        60               4
 789 │ SH                        70               3
 790 │ SH                        73               5
 791 │ SH                       117               4
                                    781 rows omitted

julia&gt; total_richness_df= @pipe df|&gt;
                  innerjoin(_,  total_presence_df, on = [:Species, :Sampling_date_order], makeunique = true) |&gt;
                  groupby(_,[:plot,:Sampling_date_order,:Longitude, :Latitude])|&gt;
                  combine(_,:Presence=&gt;sum=&gt;:Total_Richness)|&gt;
                  filter(row -&gt; row[:Total_Richness] &gt; 0, _) 

2565×5 DataFrame
  Row │ plot   Sampling_date_order  Longitude  Latitude  Total_Richness 
      │ Int64  Int64                Float64    Float64   Int64          
──────┼─────────────────────────────────────────────────────────────────
    1 │     1                   41     -110.0      35.0               5
    2 │     2                   41     -109.5      35.0               4
    3 │     4                   41     -108.5      35.0               2
    4 │     8                   41     -109.5      35.5               2
    5 │     9                   41     -109.0      35.5               3
  ⋮   │   ⋮             ⋮               ⋮         ⋮            ⋮
 2561 │     9                  117     -109.0      35.5               5
 2562 │    10                  117     -108.5      35.5               3
 2563 │    12                  117     -107.5      35.5               6
 2564 │    16                  117     -108.5      36.0               4
 2565 │    23                  117     -108.0      36.5               5
                                                       2555 rows omitted

julia&gt; clustering_result = create_clusters(total_richness_df.Sampling_date_order, total_richness_df.Latitude, total_richness_df.Longitude, total_richness_df.plot, total_richness_df.Total_Richness)
Dict{Int64, DataFrame} with 117 entries:
  5   =&gt; 17×6 DataFrame…
  56  =&gt; 23×6 DataFrame…
  55  =&gt; 24×6 DataFrame…
  35  =&gt; 23×6 DataFrame…
  110 =&gt; 24×6 DataFrame…
  114 =&gt; 22×6 DataFrame…
  60  =&gt; 24×6 DataFrame…
  30  =&gt; 20×6 DataFrame…
  32  =&gt; 22×6 DataFrame…
  6   =&gt; 19×6 DataFrame…
  67  =&gt; 23×6 DataFrame…
  45  =&gt; 23×6 DataFrame…
  117 =&gt; 24×6 DataFrame…
  73  =&gt; 23×6 DataFrame…
  ⋮   =&gt; ⋮

julia&gt; println(clustering_result[1])
14×6 DataFrame
 Row │ Time   Latitude  Longitude  Patch  Total_Richness  Group 
     │ Int64  Float64   Float64    Int64  Int64           Int64 
─────┼──────────────────────────────────────────────────────────
   1 │     1      35.0     -110.0      1               1      1
   2 │     1      35.0     -109.5      2               1      1
   3 │     1      35.5     -109.5      8               1      1
   4 │     1      35.5     -109.0      9               1      1
   5 │     1      35.5     -108.0     11               2      2
   6 │     1      36.0     -109.5     14               2      1
   7 │     1      36.0     -108.0     17               1      2
   8 │     1      36.5     -108.5     22               1      2
   9 │     1      35.0     -107.5      6               1      2
  10 │     1      36.0     -110.0     13               1      1
  11 │     1      36.0     -109.0     15               1      1
  12 │     1      36.5     -109.5     20               1      1
  13 │     1      36.5     -109.0     21               1      2
  14 │     1      36.5     -108.0     23               1      2

julia&gt; comm= @pipe df|&gt;
                  innerjoin(_,  total_presence_df, on = [:Species, :Sampling_date_order], makeunique = true) |&gt;
                  innerjoin(_,  total_richness_df, on = [:plot, :Sampling_date_order], makeunique = true) |&gt;
                  filter(row -&gt; row[:Sampling_date_order] == 1, _) |&gt;
                  select(_, [:plot, :Species, :Presence]) |&gt;
                  unstack(_, :Species, :Presence, fill=0) |&gt;
                  select(_, Not(:plot)) |&gt;
                  Matrix(_)
14×3 Matrix{Int64}:
 1  0  0
 1  0  0
 1  0  0
 1  0  0
 1  1  0
 1  1  0
 1  0  0
 0  0  1
 0  1  0
 0  1  0
 1  0  0
 0  1  0
 0  0  1
 0  0  1

julia&gt; DNCI_result = DNCI_multigroup(comm, clustering_result[1].Group, 1000; count = false)
1×5 DataFrame
 Row │ group1  group2  DNCI      CI_DNCI  S_DNCI  
     │ Int64   Int64   Float64   Float64  Float64 
─────┼────────────────────────────────────────────
   1 │      1       2  0.533635  7.06888  3.53444</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cralibe/MetaCommunityMetrics.jl">source</a></section></article><h2 id="References"><a class="docs-heading-anchor" href="#References">References</a><a id="References-1"></a><a class="docs-heading-anchor-permalink" href="#References" title="Permalink"></a></h2><ol><li>Clarke, K. R. Non-parametric multivariate analyses of changes in community structure. Australian Journal of Ecology 18, 117-143 (1993). https://doi.org:https://doi.org/10.1111/j.1442-9993.1993.tb00438.x</li><li>Gibert, C. &amp; Escarguel, G. PER-SIMPER—A new tool for inferring community assembly processes from taxon occurrences. Global Ecology and Biogeography 28, 374-385 (2019). https://doi.org:https://doi.org/10.1111/geb.12859</li><li>Vilmi, A. et al. Dispersal–niche continuum index: a new quantitative metric for assessing the relative importance of dispersal versus niche processes in community assembly. Ecography 44, 370-379 (2021). https://doi.org:https://doi.org/10.1111/ecog.05356</li></ol></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../BetaDiversity/">« Beta Diverisity Functions</a><a class="docs-footer-nextpage" href="../NicheOverlapIndex/">Niche Overlap Index Function »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.10.1 on <span class="colophon-date" title="Tuesday 8 April 2025 00:54">Tuesday 8 April 2025</span>. Using Julia version 1.6.7.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
