<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Dispersal-Niche Continuum Index (DNCI) Functions · MetaCommunityMetrics Documentation</title><meta name="title" content="Dispersal-Niche Continuum Index (DNCI) Functions · MetaCommunityMetrics Documentation"/><meta property="og:title" content="Dispersal-Niche Continuum Index (DNCI) Functions · MetaCommunityMetrics Documentation"/><meta property="twitter:title" content="Dispersal-Niche Continuum Index (DNCI) Functions · MetaCommunityMetrics Documentation"/><meta name="description" content="Documentation for MetaCommunityMetrics Documentation."/><meta property="og:description" content="Documentation for MetaCommunityMetrics Documentation."/><meta property="twitter:description" content="Documentation for MetaCommunityMetrics Documentation."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.png" alt="MetaCommunityMetrics Documentation logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">MetaCommunityMetrics Documentation</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../BetaDiversity/">Beta Diverisity Functions</a></li><li class="is-active"><a class="tocitem" href>Dispersal-Niche Continuum Index (DNCI) Functions</a><ul class="internal"><li><a class="tocitem" href="#Background"><span>Background</span></a></li><li><a class="tocitem" href="#Functionality-Overview"><span>Functionality Overview</span></a></li><li><a class="tocitem" href="#The-Functions"><span>The Functions</span></a></li><li><a class="tocitem" href="#References"><span>References</span></a></li></ul></li><li><a class="tocitem" href="../NicheOverlapIndex/">Niche Overlap Index Function</a></li><li><a class="tocitem" href="../OccupiedPatchesProportion/">Occupied Patches Proportion Function</a></li><li><a class="tocitem" href="../VariabilityMetrics/">Variability Metrics Functions</a></li><li><a class="tocitem" href="../Hypervolume/">Hypervolume Functions</a></li><li><a class="tocitem" href="../Validation/">Validation</a></li><li><a class="tocitem" href="../Benchmarking/">Benchmark Results</a></li><li><a class="tocitem" href="../Acknowledgment/">Acknowledgment</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Dispersal-Niche Continuum Index (DNCI) Functions</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Dispersal-Niche Continuum Index (DNCI) Functions</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/cralibe/MetaCommunityMetrics.jl" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Dispersal-Niche-Continuum-Index-(DNCI)-Functions"><a class="docs-heading-anchor" href="#Dispersal-Niche-Continuum-Index-(DNCI)-Functions">Dispersal-Niche Continuum Index (DNCI) Functions</a><a id="Dispersal-Niche-Continuum-Index-(DNCI)-Functions-1"></a><a class="docs-heading-anchor-permalink" href="#Dispersal-Niche-Continuum-Index-(DNCI)-Functions" title="Permalink"></a></h1><p>The Dispersal-Niche Continuum Index (DNCI) functions in <code>MetaCommunityMetrics</code> quantifies the balance between dispersal and niche processes within a metacommunity, providing insight into community structure and the relative influence of these two key ecological drivers. The function <code>DNCI_multigroup()</code> in this package is adapted from the R package <code>DNCImper</code>.</p><h2 id="Background"><a class="docs-heading-anchor" href="#Background">Background</a><a id="Background-1"></a><a class="docs-heading-anchor-permalink" href="#Background" title="Permalink"></a></h2><p>Vilmi et al. (2021) developed DNCI based on the PER-SIMPER method introduced by Gibert and Escarguel (2019) to compare observed community composition against three null model scenarios: (1) a niche assembly model that randomizes species identities while maintaining site-level species richness, (2) a dispersal assembly model that randomizes spatial locations while maintaining species-level occurrence frequencies, and (3) a combined model that maintains both constraints (Vilmi et al. 2021). PER-SIMPER uses the SIMPER analysis (Clarke 1993) to generate the profiles of species contributions to average between-group dissimilarity for both the observed data and the community matrices permuted by the three corresponding null models (i.e. the PER-SIMPER profiles), where dissimilarity is averaged across all site pairs, one site from each group (Gibert and Escarguel 2019). PER-SIMPER provides qualitative analysis of similarity between the observed SIMPER profile and null model PER-SIMPER profiles, while DNCI quantifies these similarities to calculate the relative importance of dispersal and niche processe.</p><h2 id="Functionality-Overview"><a class="docs-heading-anchor" href="#Functionality-Overview">Functionality Overview</a><a id="Functionality-Overview-1"></a><a class="docs-heading-anchor-permalink" href="#Functionality-Overview" title="Permalink"></a></h2><p>Unlike the other metrics in this package, DNCI analysis operates on only one time point at a time. Positive DNCI values suggest niche processes dominate community assembly, while negative DNCI values suggest dispersal limitation is more influential at a given time point. DNCI values that do not differ significantly from zero suggest equal contributions from both processes at a given time point. </p><p>Before calculating the DNCI, groupings of sites are required, as the DNCI relies on analyzing community composition across site groups. This package provides <code>create_groups()</code> to perform the necessary groupings for all time points, and  <code>plot_groups()</code> to visualize the groupings at a given time points, which are not available in the R implementation. </p><h2 id="The-Functions"><a class="docs-heading-anchor" href="#The-Functions">The Functions</a><a id="The-Functions-1"></a><a class="docs-heading-anchor-permalink" href="#The-Functions" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MetaCommunityMetrics.create_groups" href="#MetaCommunityMetrics.create_groups"><code>MetaCommunityMetrics.create_groups</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">create_groups(time::AbstractVector, latitude::Vector{Float64}, longitude::Vector{Float64}, site::AbstractVector, species::AbstractVector, presence::AbstractVector) -&gt; Dict{Int, DataFrame}</code></pre><p>This function creates groupings of sites for each unique time step in a dataset which can then used for calculating DNCI. Only presnece-absence data can be used.</p><p>Arguments</p><ul><li><code>time::AbstractVector</code>: Vector or single value representing sampling dates. Can be strings, integers, or any other type.</li><li><code>latitude::Vector</code>: A vector indicating the latitude of each site.</li><li><code>longitude::Vector</code>: A vector indicating the longitude of each site.</li><li><code>site::AbstractVector</code>: A vector indicating the spatial location of each site. At least 10 sites are required for clustering.</li><li><code>species::AbstractVector</code>: A vector indicating the species present at each site.</li><li><code>presence::AbstractVector</code>: A vector indicating the presence (1) or absence (0) of species at each site.</li></ul><p>Returns</p><ul><li><code>Dict{Int, DataFrame}</code>: A dictionary where each key represents a unique time point from the input data, with the corresponding value being a <code>DataFrame</code> for that time step. Each <code>DataFrame</code> contains the following columns:<ul><li><code>Time</code></li><li><code>Latitude</code></li><li><code>Longitude</code></li><li><code>Site</code></li><li><code>Species</code></li><li><code>Presence</code></li><li><code>Group</code> (indicating the assigned groups).</li></ul></li></ul><p>Details</p><ul><li>This function performs hierarchical clustering on the geographical coordinates of sampling sites at each time point separately and processes all time points in a single execution. </li><li>This function incorporates checks and adjustments to ensure the following conditions are met: <ul><li>Having at least 2 groups</li><li>A minimum of 5 sites per group, </li><li>The variation in the number of taxa/species and sites per group does not exceed 40% and 30%, respectively. </li></ul>These conditions are critical for calculating an unbiased DNCI value, and the function will issue warnings and the groupings will be returned as &quot;missing&quot; if any of the above are not fulfilled.</li><li>Empty sites are allowed.</li></ul><p>Example</p><pre><code class="language-jildoctest hljs">julia&gt; using MetaCommunityMetrics, Pipe, DataFrames

julia&gt; df = load_sample_data()
53352×12 DataFrame
   Row │ Year   Month  Day    Sampling_date_order  plot   Species  Abundance  Presence  Latitude  Longitude  standardized_temperature  standardized_precipitation 
       │ Int64  Int64  Int64  Int64                Int64  String3  Int64      Int64     Float64   Float64    Float64                 Float64                  
───────┼──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     1 │  2010      1     16                    1      1  BA               0         0      35.0     -110.0                0.829467              -1.4024
     2 │  2010      1     16                    1      2  BA               0         0      35.0     -109.5               -1.12294               -0.0519895
     3 │  2010      1     16                    1      4  BA               0         0      35.0     -108.5               -0.409808              -0.803663
     4 │  2010      1     16                    1      8  BA               0         0      35.5     -109.5               -1.35913               -0.646369
     5 │  2010      1     16                    1      9  BA               0         0      35.5     -109.0                0.0822                 1.09485
   ⋮   │   ⋮      ⋮      ⋮             ⋮             ⋮       ⋮         ⋮         ⋮         ⋮          ⋮                ⋮                        ⋮
 53348 │  2023      3     21                  117      9  SH               0         0      35.5     -109.0               -0.571565              -0.836345
 53349 │  2023      3     21                  117     10  SH               0         0      35.5     -108.5               -2.33729               -0.398522
 53350 │  2023      3     21                  117     12  SH               1         1      35.5     -107.5                0.547169               1.03257
 53351 │  2023      3     21                  117     16  SH               0         0      36.0     -108.5               -0.815015               0.95971
 53352 │  2023      3     21                  117     23  SH               0         0      36.5     -108.0                0.48949               -1.59416
                                                                                                                                            53342 rows omitted
                                                                                          
julia&gt; grouping_result = create_groups(df.Sampling_date_order, df.Latitude, df.Longitude, df.plot, df.Species, df.Presence)
Warning: Group count fell below 2 at time 10, which is not permissible for DNCI analysis. Groups assigned as missing.
Warning: Group count fell below 2 at time 14, which is not permissible for DNCI analysis. Groups assigned as missing.
Warning: Group count fell below 2 at time 76, which is not permissible for DNCI analysis. Groups assigned as missing.
Warning: Group count fell below 2 at time 89, which is not permissible for DNCI analysis. Groups assigned as missing.
Warning: Group count fell below 2 at time 99, which is not permissible for DNCI analysis. Groups assigned as missing.
Dict{Int64, DataFrames.DataFrame} with 117 entries:
  5   =&gt; 456×7 DataFrame…
  56  =&gt; 456×7 DataFrame…
  35  =&gt; 456×7 DataFrame…
  55  =&gt; 456×7 DataFrame…
  110 =&gt; 456×7 DataFrame…
  114 =&gt; 456×7 DataFrame…
  60  =&gt; 456×7 DataFrame…
  30  =&gt; 456×7 DataFrame…
  32  =&gt; 456×7 DataFrame…
  6   =&gt; 456×7 DataFrame…
  67  =&gt; 456×7 DataFrame…
  45  =&gt; 456×7 DataFrame…
  117 =&gt; 456×7 DataFrame…
  73  =&gt; 456×7 DataFrame…
  ⋮   =&gt; ⋮

julia&gt; grouping_result[10]      
456×7 DataFrame
 Row │ Time   Latitude  Longitude  Site   Species  Presence  Group   
     │ Int64  Float64   Float64    Int64  String3  Int64     Missing 
─────┼───────────────────────────────────────────────────────────────
   1 │    10      35.0     -110.0      1  BA              0  missing 
   2 │    10      35.0     -109.5      2  BA              0  missing 
   3 │    10      35.0     -108.5      4  BA              0  missing 
   4 │    10      35.5     -109.5      8  BA              0  missing 
   5 │    10      35.5     -109.0      9  BA              0  missing 
  ⋮  │   ⋮       ⋮          ⋮        ⋮       ⋮        ⋮         ⋮
 452 │    10      35.5     -110.0      7  SH              0  missing 
 453 │    10      35.5     -108.5     10  SH              0  missing 
 454 │    10      36.0     -108.5     16  SH              0  missing 
 455 │    10      36.5     -108.0     23  SH              0  missing 
 456 │    10      36.5     -107.5     24  SH              0  missing 
                                                     446 rows omitted      
 
julia&gt; grouping_result[60]                                                      
456×7 DataFrame
 Row │ Time   Latitude  Longitude  Site   Species  Presence  Group  
     │ Int64  Float64   Float64    Int64  String3  Int64     Int64? 
─────┼──────────────────────────────────────────────────────────────
   1 │    60      35.0     -108.5      4  BA              0       1
   2 │    60      35.0     -108.0      5  BA              1       1
   3 │    60      35.0     -107.5      6  BA              0       1
   4 │    60      35.5     -110.0      7  BA              0       2
   5 │    60      35.5     -108.0     11  BA              0       1
  ⋮  │   ⋮       ⋮          ⋮        ⋮       ⋮        ⋮        ⋮
 452 │    60      35.5     -109.0      9  SH              0       2
 453 │    60      35.5     -108.5     10  SH              0       1
 454 │    60      35.5     -107.5     12  SH              1       1
 455 │    60      36.0     -108.5     16  SH              0       4
 456 │    60      36.5     -108.0     23  SH              0       4
                                                    446 rows omitted</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cralibe/MetaCommunityMetrics.jl">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MetaCommunityMetrics.plot_groups" href="#MetaCommunityMetrics.plot_groups"><code>MetaCommunityMetrics.plot_groups</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">plot_groups(latitude::Vector{Float64}, longitude::Vector{Float64}, group::AbstractVector, output_file=&quot;groups.svg&quot;) -&gt; String</code></pre><p>Visualizes grouping results by generating an SVG image displaying the geographic coordinates and cluster assignments of sampling sites.</p><p><strong>Arguments</strong></p><ul><li><code>latitude::Vector{Float64}</code>: A vector of latitude coordinates of the sampling sites.</li><li><code>longitude::Vector{Float64}</code>: A vector of longitude coordinates of the sampling sites.</li><li><code>group::AbstractVector</code>: A vector indicating the group assignments for each data point.</li><li><code>output_file::String=&quot;clusters.svg&quot;</code>: The filename for the output SVG visualization. Default is &quot;groups.svg&quot;.</li></ul><p><strong>Returns</strong></p><ul><li><code>String</code>: The path to the created SVG file.</li></ul><p><strong>Details</strong></p><ul><li>The functions provides visualization for one time point per function call.</li><li>The function generates a standalone SVG file that can be viewed in any web browser or image viewer.</li><li>Each group is assigned a unique color, and sampling sites are plotted based on their geographic coordinates.</li><li>The visualization includes a legend identifying each group.</li></ul><p>Example</p><pre><code class="language-jildoctest hljs">julia&gt; using MetaCommunityMetrics, Pipe, DataFrames

julia&gt; df = load_sample_data()
53352×12 DataFrame
   Row │ Year   Month  Day    Sampling_date_order  plot   Species  Abundance  Presence  Latitude  Longitude  standardized_temperature  standardized_precipitation 
       │ Int64  Int64  Int64  Int64                Int64  String3  Int64      Int64     Float64   Float64    Float64                 Float64                  
───────┼──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     1 │  2010      1     16                    1      1  BA               0         0      35.0     -110.0                0.829467              -1.4024
     2 │  2010      1     16                    1      2  BA               0         0      35.0     -109.5               -1.12294               -0.0519895
     3 │  2010      1     16                    1      4  BA               0         0      35.0     -108.5               -0.409808              -0.803663
     4 │  2010      1     16                    1      8  BA               0         0      35.5     -109.5               -1.35913               -0.646369
     5 │  2010      1     16                    1      9  BA               0         0      35.5     -109.0                0.0822                 1.09485
   ⋮   │   ⋮      ⋮      ⋮             ⋮             ⋮       ⋮         ⋮         ⋮         ⋮          ⋮                ⋮                        ⋮
 53348 │  2023      3     21                  117      9  SH               0         0      35.5     -109.0               -0.571565              -0.836345
 53349 │  2023      3     21                  117     10  SH               0         0      35.5     -108.5               -2.33729               -0.398522
 53350 │  2023      3     21                  117     12  SH               1         1      35.5     -107.5                0.547169               1.03257
 53351 │  2023      3     21                  117     16  SH               0         0      36.0     -108.5               -0.815015               0.95971
 53352 │  2023      3     21                  117     23  SH               0         0      36.5     -108.0                0.48949               -1.59416
                                                                                                                                            53342 rows omitted
                                                                                          
julia&gt; grouping_result = create_groups(df.Sampling_date_order, df.Latitude, df.Longitude, df.plot, df.Species, df.Presence)
Warning: Group count fell below 2 at time 10, which is not permissible for DNCI analysis. Groups assigned as missing.
Warning: Group count fell below 2 at time 14, which is not permissible for DNCI analysis. Groups assigned as missing.
Warning: Group count fell below 2 at time 76, which is not permissible for DNCI analysis. Groups assigned as missing.
Warning: Group count fell below 2 at time 89, which is not permissible for DNCI analysis. Groups assigned as missing.
Warning: Group count fell below 2 at time 99, which is not permissible for DNCI analysis. Groups assigned as missing.
Dict{Int64, DataFrames.DataFrame} with 117 entries:
  5   =&gt; 456×7 DataFrame…
  56  =&gt; 456×7 DataFrame…
  35  =&gt; 456×7 DataFrame…
  55  =&gt; 456×7 DataFrame…
  110 =&gt; 456×7 DataFrame…
  114 =&gt; 456×7 DataFrame…
  60  =&gt; 456×7 DataFrame…
  30  =&gt; 456×7 DataFrame…
  32  =&gt; 456×7 DataFrame…
  6   =&gt; 456×7 DataFrame…
  67  =&gt; 456×7 DataFrame…
  45  =&gt; 456×7 DataFrame…
  117 =&gt; 456×7 DataFrame…
  73  =&gt; 456×7 DataFrame…
  ⋮   =&gt; ⋮

julia&gt; grouping_result[60]                                                      
456×7 DataFrame
 Row │ Time   Latitude  Longitude  Site   Species  Presence  Group  
     │ Int64  Float64   Float64    Int64  String3  Int64     Int64? 
─────┼──────────────────────────────────────────────────────────────
   1 │    60      35.0     -108.5      4  BA              0       1
   2 │    60      35.0     -108.0      5  BA              1       1
   3 │    60      35.0     -107.5      6  BA              0       1
   4 │    60      35.5     -110.0      7  BA              0       2
   5 │    60      35.5     -108.0     11  BA              0       1
  ⋮  │   ⋮       ⋮          ⋮        ⋮       ⋮        ⋮        ⋮
 452 │    60      35.5     -109.0      9  SH              0       2
 453 │    60      35.5     -108.5     10  SH              0       1
 454 │    60      35.5     -107.5     12  SH              1       1
 455 │    60      36.0     -108.5     16  SH              0       4
 456 │    60      36.5     -108.0     23  SH              0       4
                                                    446 rows omitted

julia&gt; plot_groups(grouping_result[60].Latitude, grouping_result[60].Longitude, grouping_result[60].Group; output_file=&quot;groups.svg&quot;)
</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cralibe/MetaCommunityMetrics.jl">source</a></section></article><p>This plot shows the clustering result for time step 1 based on geographic coordinates: <img src="../assets/groups.svg" alt="Cluster Plot"/></p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MetaCommunityMetrics.DNCI_multigroup" href="#MetaCommunityMetrics.DNCI_multigroup"><code>MetaCommunityMetrics.DNCI_multigroup</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">DNCI_multigroup(comm::Matrix, groups::Vector, Nperm::Int=1000; Nperm_count::Bool=true) -&gt; DataFrame</code></pre><p>Calculates the dispersal-niche continuum index (DNCI) for a metacommunity, a metric proposed by Vilmi(2021). The DNCI quantifies the balance between dispersal and niche processes within a metacommunity, providing insight into community structure and the relative influence of these two key ecological drivers. </p><p>Arguments</p><ul><li><code>comm::Matrix</code>: A presence-absence data matrix where rows represent observations (e.g., sites) and columns represent species.</li><li><code>groups::Vector</code>: A vector indicating the group membership for each row in the <code>comm</code> matrix. You can use the <code>create_clusters</code> function to generate the group membership.</li><li><code>Nperm::Int=1000</code>: The number of permutations for significance testing. Default is 1000.</li><li><code>Nperm_count::Bool=true</code>: A flag indicating whether the number of permutations is printed. Default is <code>false</code>.</li></ul><p>Returns The DataFrame will have the following columns:</p><ul><li><code>Group1</code>: The first group in the pair.</li><li><code>Group2</code>: The second group in the pair.</li><li><code>DNCI</code>: The calculated DNCI value.</li><li><code>CI_DNCI</code>: The confidence interval for the DNCI value.</li><li><code>S_DNCI</code>: The standard deviation of the DNCI value.</li><li><code>Status</code>: A string indicating how the DNCI is calculated. It is mainly used to flag edge cases as follows:<ul><li><code>normal</code> indicates that the DNCI is calculated as normal.</li><li><code>empty_community</code> indicates no species existed in any sites in a given group pair, <code>DNCI</code>, <code>CI_DNCI</code>, and <code>S_DNCI</code> are returned as <code>NaN</code>.</li><li><code>only_one_species_exists</code> indicates that only one species existed in a given group pair, which is not possible to calculate relative species contribution to overall dissimilarity. <code>DNCI</code>, <code>CI_DNCI</code>, and <code>S_DNCI</code> are returned as <code>NaN</code>.</li><li><code>quasi_swap_permutation_not_possible</code> indicates that the quasi-swap permutation (a matrix permutation algorithms that preserves row and column sums) is not possible due to extreme matrix constraints that prevent any rearrangement of species across sites. <code>DNCI</code>, <code>CI_DNCI</code>, and <code>S_DNCI</code> are returned as <code>NaN</code>.</li><li><code>one_way_to_quasi_swap</code> indicates that only one arrangement is possible under quasi-swap constraints, preventing generation of a null distribution. <code>DNCI</code>, <code>CI_DNCI</code>, and <code>S_DNCI</code> are returned as <code>NaN</code>.</li><li><code>inadequate_variation_quasi_swap</code> indicates that quasi-swap permutations generated insufficient variation (coefficient of variation &lt;1%) for reliable statistical inference. <code>DNCI</code>, <code>CI_DNCI</code>, and <code>S_DNCI</code> are returned as <code>NaN</code>.</li></ul></li></ul><p>Details</p><ul><li>The function calculates the DNCI for each pair of groups in the input data.</li><li>When the DNCI value is significantly below zero, dispersal processes are likely the dominant drivers of community composition. </li><li>In contrast, a DNCI value significantly above zero suggests that niche processes play a primary role in shaping community composition. </li><li>If the DNCI value is not significantly different from zero, it indicates that dispersal and niche processes contribute equally to spatial variations in community composition at a given time point.</li><li>Different from the original implementation, empty sites and singletons (species that only occupy one site at a given time) are allowed.</li><li>This function is a adaptation of the function <code>DNCI_multigroup()</code> from the R package <code>DNCImper</code>, licensed under GPL-3.</li><li>Original package and documentation available at: https://github.com/Corentin-Gibert-Paleontology/DNCImper</li></ul><p>Example</p><pre><code class="language-jildoctest hljs">julia&gt; using MetaCommunityMetrics, Pipe, DataFrames, Random

julia&gt; df = load_sample_data()
53352×12 DataFrame
   Row │ Year   Month  Day    Sampling_date_order  plot   Species  Abundance  Presence  Latitude  Longitude  standardized_temperature  standardized_precipitation 
       │ Int64  Int64  Int64  Int64                Int64  String3  Int64      Int64     Float64   Float64    Float64                 Float64                  
───────┼──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     1 │  2010      1     16                    1      1  BA               0         0      35.0     -110.0                0.829467              -1.4024
     2 │  2010      1     16                    1      2  BA               0         0      35.0     -109.5               -1.12294               -0.0519895
     3 │  2010      1     16                    1      4  BA               0         0      35.0     -108.5               -0.409808              -0.803663
     4 │  2010      1     16                    1      8  BA               0         0      35.5     -109.5               -1.35913               -0.646369
     5 │  2010      1     16                    1      9  BA               0         0      35.5     -109.0                0.0822                 1.09485
   ⋮   │   ⋮      ⋮      ⋮             ⋮             ⋮       ⋮         ⋮         ⋮         ⋮          ⋮                ⋮                        ⋮
 53348 │  2023      3     21                  117      9  SH               0         0      35.5     -109.0               -0.571565              -0.836345
 53349 │  2023      3     21                  117     10  SH               0         0      35.5     -108.5               -2.33729               -0.398522
 53350 │  2023      3     21                  117     12  SH               1         1      35.5     -107.5                0.547169               1.03257
 53351 │  2023      3     21                  117     16  SH               0         0      36.0     -108.5               -0.815015               0.95971
 53352 │  2023      3     21                  117     23  SH               0         0      36.5     -108.0                0.48949               -1.59416
                                                                                                                                            53342 rows omitted
                                                                                          
julia&gt; grouping_result = create_groups(df.Sampling_date_order, df.Latitude, df.Longitude, df.plot, df.Species, df.Presence)
Warning: Group count fell below 2 at time 10, which is not permissible for DNCI analysis. Groups assigned as missing.
Warning: Group count fell below 2 at time 14, which is not permissible for DNCI analysis. Groups assigned as missing.
Warning: Group count fell below 2 at time 76, which is not permissible for DNCI analysis. Groups assigned as missing.
Warning: Group count fell below 2 at time 89, which is not permissible for DNCI analysis. Groups assigned as missing.
Warning: Group count fell below 2 at time 99, which is not permissible for DNCI analysis. Groups assigned as missing.
Dict{Int64, DataFrames.DataFrame} with 117 entries:
  5   =&gt; 456×7 DataFrame…
  56  =&gt; 456×7 DataFrame…
  35  =&gt; 456×7 DataFrame…
  55  =&gt; 456×7 DataFrame…
  110 =&gt; 456×7 DataFrame…
  114 =&gt; 456×7 DataFrame…
  60  =&gt; 456×7 DataFrame…
  30  =&gt; 456×7 DataFrame…
  32  =&gt; 456×7 DataFrame…
  6   =&gt; 456×7 DataFrame…
  67  =&gt; 456×7 DataFrame…
  45  =&gt; 456×7 DataFrame…
  117 =&gt; 456×7 DataFrame…
  73  =&gt; 456×7 DataFrame…
  ⋮   =&gt; ⋮

julia&gt; grouping_result[60]
456×7 DataFrame
 Row │ Time   Latitude  Longitude  Site   Species  Presence  Group  
     │ Int64  Float64   Float64    Int64  String3  Int64     Int64? 
─────┼──────────────────────────────────────────────────────────────
   1 │    60      35.0     -108.5      4  BA              0       1
   2 │    60      35.0     -108.0      5  BA              1       1
   3 │    60      35.0     -107.5      6  BA              0       1
   4 │    60      35.5     -110.0      7  BA              0       2
   5 │    60      35.5     -108.0     11  BA              0       1
  ⋮  │   ⋮       ⋮          ⋮        ⋮       ⋮        ⋮        ⋮
 452 │    60      35.5     -109.0      9  SH              0       2
 453 │    60      35.5     -108.5     10  SH              0       1
 454 │    60      35.5     -107.5     12  SH              1       1
 455 │    60      36.0     -108.5     16  SH              0       4
 456 │    60      36.5     -108.0     23  SH              0       4
                                                    446 rows omitted

julia&gt; group_df = @pipe df |&gt;
                filter(row -&gt; row[:Sampling_date_order] == 60, _) |&gt;
                select(_, [:plot, :Species, :Presence]) |&gt;
                innerjoin(_, grouping_result[60], on = [:plot =&gt; :Site, :Species], makeunique = true)|&gt;
                select(_, [:plot, :Species, :Presence, :Group]) |&gt;
                unstack(_, :Species, :Presence, fill=0)
24×21 DataFrame
 Row │ plot   Group   BA     DM     DO     DS     NA     OL     OT     PB     PE     PF     PH     PL     PM     PP     RF     RM     RO     SF     SH    
     │ Int64  Int64?  Int64  Int64  Int64  Int64  Int64  Int64  Int64  Int64  Int64  Int64  Int64  Int64  Int64  Int64  Int64  Int64  Int64  Int64  Int64 
─────┼────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
   1 │     4       1      0      1      1      0      0      1      1      0      0      0      0      0      0      0      0      1      0      1      0
   2 │     5       1      1      1      1      0      0      0      1      0      1      0      0      0      0      1      0      1      0      0      0
   3 │     6       1      0      1      1      0      0      0      0      0      1      0      0      0      0      1      0      1      0      0      0
   4 │     7       2      0      1      1      0      0      1      1      0      0      0      0      0      0      1      0      0      0      0      1
   5 │    11       1      0      1      1      0      0      0      1      0      0      0      0      0      0      1      0      0      0      0      0
  ⋮  │   ⋮      ⋮       ⋮      ⋮      ⋮      ⋮      ⋮      ⋮      ⋮      ⋮      ⋮      ⋮      ⋮      ⋮      ⋮      ⋮      ⋮      ⋮      ⋮      ⋮      ⋮
  20 │     9       2      0      1      0      0      0      1      1      0      1      0      0      0      0      0      0      0      0      0      0
  21 │    10       1      0      0      0      0      0      0      0      0      1      0      0      0      0      1      0      0      0      0      0
  22 │    12       1      0      0      0      0      1      0      1      0      1      0      0      0      1      0      0      1      0      0      1
  23 │    16       4      0      0      1      0      0      0      1      0      1      0      0      0      0      0      0      1      0      0      0
  24 │    23       4      0      1      0      0      0      0      0      1      0      0      0      0      1      0      0      0      0      0      0
                                                                                                                                           14 rows omitted
                                                                                                                                          
julia&gt; comm= @pipe group_df |&gt;
                  select(_, Not([:plot,:Group])) |&gt;
                  Matrix(_)
24×19 Matrix{Int64}:
 0  1  1  0  0  1  1  0  0  0  0  0  0  0  0  1  0  1  0
 1  1  1  0  0  0  1  0  1  0  0  0  0  1  0  1  0  0  0
 0  1  1  0  0  0  0  0  1  0  0  0  0  1  0  1  0  0  0
 0  1  1  0  0  1  1  0  0  0  0  0  0  1  0  0  0  0  1
 0  1  1  0  0  0  1  0  0  0  0  0  0  1  0  0  0  0  0
 0  1  1  0  0  0  0  1  1  0  0  0  0  0  0  1  0  0  0
 1  1  1  0  0  0  0  0  0  0  0  0  0  1  0  1  0  0  0
 ⋮              ⋮              ⋮              ⋮        
 0  0  0  0  0  1  0  1  0  0  0  0  0  0  0  0  0  0  0
 0  0  0  0  0  0  1  0  1  0  0  1  1  0  0  0  0  0  0
 0  1  0  0  0  1  1  0  1  0  0  0  0  0  0  0  0  0  0
 0  0  0  0  0  0  0  0  1  0  0  0  0  1  0  0  0  0  0
 0  0  0  0  1  0  1  0  1  0  0  0  1  0  0  1  0  0  1
 0  0  1  0  0  0  1  0  1  0  0  0  0  0  0  1  0  0  0
 0  1  0  0  0  0  0  1  0  0  0  0  1  0  0  0  0  0  0

julia&gt; Random.seed!(1234) 

julia&gt; DNCI_result = DNCI_multigroup(comm, group_df.Group, 1000; Nperm_count = false)
6×6 DataFrame
 Row │ group1  group2  DNCI      CI_DNCI  S_DNCI    status 
     │ Int64   Int64   Float64   Float64  Float64   String 
─────┼─────────────────────────────────────────────────────
   1 │      1       2  -3.41127  2.17348  1.08674   normal
   2 │      1       3  -2.44866  2.05951  1.02976   normal
   3 │      1       4  -2.3671   2.45697  1.22848   normal
   4 │      2       3  -2.65022  2.28931  1.14466   normal
   5 │      2       4  -3.0168   2.43496  1.21748   normal
   6 │      3       4  -1.83521  1.9589   0.979449  normal</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cralibe/MetaCommunityMetrics.jl">source</a></section></article><h2 id="References"><a class="docs-heading-anchor" href="#References">References</a><a id="References-1"></a><a class="docs-heading-anchor-permalink" href="#References" title="Permalink"></a></h2><ol><li>Clarke, K. R. (1993). Non‐parametric multivariate analyses of changes in community structure. Australian journal of ecology, 18(1), 117-143. https://doi.org:https://doi.org/10.1111/j.1442-9993.1993.tb00438.x</li><li>Gibert, C., &amp; Escarguel, G. (2019). PER‐SIMPER—A new tool for inferring community assembly processes from taxon occurrences. Global Ecology and Biogeography, 28(3), 374-385. https://doi.org:https://doi.org/10.1111/geb.12859</li><li>Vilmi, A., Gibert, C., Escarguel, G., Happonen, K., Heino, J., Jamoneau, A., ... &amp; Wang, J. (2021). Dispersal–niche continuum index: a new quantitative metric for assessing the relative importance of dispersal versus niche processes in community assembly. Ecography, 44(3), 370-379. https://doi.org:https://doi.org/10.1111/ecog.05356</li></ol></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../BetaDiversity/">« Beta Diverisity Functions</a><a class="docs-footer-nextpage" href="../NicheOverlapIndex/">Niche Overlap Index Function »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.11.3 on <span class="colophon-date" title="Tuesday 26 August 2025 02:52">Tuesday 26 August 2025</span>. Using Julia version 1.9.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
